# 🌏 智能旅游助手Agent系统

> 生产级旅游智能Agent Web应用 | 基于Gradio 4.x | 纯API驱动 | 一键启动

## 📋 项目简介

这是一个功能完整、开箱即用的**智能旅游助手Agent系统**，采用最新的Gradio 4.x框架搭建，通过调用第三方大模型API（Claude/OpenAI等）实现强大的AI能力。本项目不是简单的问答机器人，而是具备**自主思考、主动规划、动态优化**能力的专业旅游智能体。

### 🎯 核心特性

✅ **纯三方API调用** - 无本地模型，无LangChain/LLaMAIndex依赖，轻量化部署  
✅ **智能Agent能力** - 主动需求挖掘、多方案规划、任务拆解、动态调整  
✅ **多模态交互** - 文本对话 + 图片识别 + 语音交互 全链路支持  
✅ **专业旅游规划** - 行程规划、景点推荐、酒店美食、应急方案  
✅ **场景智能适配** - 自动识别亲子游、老年游、穷游、境外游等场景  
✅ **美观现代界面** - 旅游主题风格，响应式设计，全设备适配  
✅ **一键启动运行** - 配置简单，运行即用，零门槛上手  

---

## 🚀 快速开始

### 1️⃣ 环境要求

- Python 3.10 或更高版本
- 稳定的网络连接（用于调用API）
- 第三方大模型API密钥（Claude或OpenAI）

### 2️⃣ 安装依赖

```bash
# 克隆或下载项目后，进入项目目录
cd travel-assistant-agent

# 安装依赖包
pip install -r requirements.txt
```

### 3️⃣ 配置API密钥

```bash
# 复制环境变量示例文件
cp .env.example .env

# 编辑.env文件，填入您的API密钥
# 使用任意文本编辑器打开.env文件，修改以下内容：
```

**.env 配置示例：**

```env
# 使用Claude API
API_KEY=sk-ant-xxxxxxxxxxxxx
API_BASE_URL=https://api.anthropic.com
MODEL_NAME=claude-3-5-sonnet-20241022

# 或使用OpenAI API
# API_KEY=sk-xxxxxxxxxxxxx
# API_BASE_URL=https://api.openai.com
# MODEL_NAME=gpt-4-turbo-preview
```

### 4️⃣ 启动应用

```bash
# 运行主程序
python app.py
```

启动成功后，浏览器会自动打开应用页面（默认地址：http://localhost:7860）

---

## 💡 核心功能详解

### 🤖 智能Agent能力（重中之重）

#### 1. 主动需求挖掘
用户信息不全时，Agent会友好地追问关键信息：
- 目的地在哪里？
- 计划玩几天？
- 几个人出行？有老人或小孩吗？
- 大概预算是多少？
- 更喜欢哪种风格（自然风光/历史文化/美食等）？

#### 2. 多方案最优规划
自动生成2-3套差异化方案，每套方案包含：
- **方案特点**：经典打卡版/小众秘境版/亲子轻松版/穷游省钱版
- **总预算**：详细的费用估算
- **适配人群**：适合哪类旅行者
- **优缺点对比**：帮助用户做出最优选择

#### 3. 专业旅游分析
- ✅ 优化路线，减少往返折腾
- ✅ 规避景点闭园时间
- ✅ 避开人流高峰时段
- ✅ 合理分配预算
- ✅ 主动给出避坑贴士

#### 4. 任务拆解执行
将复杂需求拆解为细分任务并逐一完成：
```
用户需求："带爸妈去西安玩4天"
↓
Agent自动拆解：
1. 筛选老人友好景点（有观光车、休息区）
2. 规划低强度行程（每天2-3个景点）
3. 推荐就近无障碍酒店
4. 筛选清淡地道美食
5. 补充老人出行贴士（常备药、医疗机构）
6. 生成完整行程
```

#### 5. 动态优化调整
根据用户反馈实时调整，无需重新生成：
- "行程太赶" → 立刻减少景点，增加休息时间
- "加一个小众景点" → 无缝融入并优化路线
- "预算太高" → 替换为性价比更高的选项

#### 6. 人群智能适配
自动识别并适配不同人群需求：

| 人群类型 | 自动优化内容 |
|---------|-------------|
| **亲子游** | 儿童友好景点、母婴室、儿童票、推车租赁 |
| **老年游** | 低强度路线、观光车、无障碍设施、清淡美食 |
| **学生穷游** | 免费景点、学生证优惠、青旅、平价美食 |
| **情侣游** | 浪漫景点、情侣酒店、特色餐厅、拍照打卡 |
| **轻奢游** | 高端酒店、米其林餐厅、私人导游、VIP服务 |
| **境外游** | 签证、货币兑换、当地交通、语言贴士、应急联系 |

---

### 📱 多模态交互

#### 文本对话
- 支持多轮对话，保持上下文记忆
- 结构化输出，清晰易读
- 实时响应，流畅体验

#### 图片识别
支持上传以下类型的图片：
- 🏛️ **景点照片** → 识别景点名称，返回攻略、门票、交通
- 🏨 **酒店图片** → 识别酒店信息，给出性价比分析
- 🍜 **美食照片** → 识别菜品，推荐类似美食
- 🗺️ **地图截图** → 分析路线，优化行程
- 🎫 **票据照片** → 识别机票/高铁票/门票信息

#### 语音交互（简化版）
- 按住录音，松开识别
- 语音回答口语化，适合播报
- 短句清晰，核心信息前置

---

### 🛠️ 实用工具

#### 行程保存
- 一键保存满意的行程方案
- 自动生成带时间戳的文件名
- 支持Markdown格式，便于编辑和分享

#### 行程导出
- 导出为纯文本格式
- 清晰的结构化排版
- 可直接复制或打印

#### 快速提问
预置常见问题，一键发送：
- "给我推荐一个适合周末的短途旅行目的地"
- "帮我规划一个3天2夜的杭州行程"
- "带父母去成都旅游，有什么建议？"
- "预算3000元，想去海边玩几天"
- ...更多

---

## 🎨 界面设计

### 视觉风格
- **主色调**：晴空蓝（#1890ff）- 清新明快
- **辅助色**：暖橙色（#ff9800）- 温馨友好
- **布局**：单页简洁设计，无多余跳转
- **风格**：现代化旅游主题，轻量治愈

### 响应式适配
- 💻 **电脑端**：全屏展示，功能完整
- 📱 **手机端**：竖屏优化，操作便捷
- 📱 **平板端**：自适应布局，体验流畅

### 交互体验
- ⚡ 即时反馈：加载动画、状态提示
- 📊 结构化展示：时间轴、项目符号、醒目标签
- ⚠️ 友好提示：温馨的中文错误提示，无冰冷报错码

---

## 📂 项目结构

```
travel-assistant-agent/
├── app.py                      # 主程序入口
├── requirements.txt            # 依赖清单
├── .env.example               # 环境变量示例
├── .env                       # 环境变量配置（需自行创建）
├── .gitignore                 # Git忽略规则
├── README.md                  # 项目说明文档
├── config/                    # 配置模块
│   ├── __init__.py
│   └── prompts.py            # Prompt提示词体系
└── data/                      # 数据目录
    └── saved_itineraries/    # 保存的行程文件
```

---

## 🔧 技术架构

### 核心技术栈
- **前后端框架**：Gradio 4.x（一体化开发）
- **开发语言**：Python 3.10+
- **API调用**：Requests（轻量HTTP客户端）
- **环境管理**：Python-dotenv
- **图片处理**：Pillow

### 设计原则
1. **轻量化**：只引入必要依赖，无冗余包
2. **模块化**：代码结构清晰，易于维护和扩展
3. **可配置**：核心参数统一管理，灵活调整
4. **高可用**：完善的异常处理，稳定可靠
5. **易部署**：一键安装，开箱即用

### Prompt体系架构

```
Prompt组合优先级：
1. AGENT核心系统Prompt（定义Agent基础能力）
2. 多模态专项Prompt（图片/视频识别规范）
3. 语音专项Prompt（口语化输出规范）
4. 场景化Prompt（亲子/老年/穷游/境外等）
5. 用户输入的需求
```

---

## 🌟 使用示例

### 示例1：周末短途游

**用户输入**：
```
想周末去个短途旅行，放松一下
```

**Agent响应**：
```
好的！我来帮您规划周末短途游。为了给您更精准的方案，想确认几个信息：

1. 您从哪个城市出发呢？
2. 周末是2天1夜还是1天往返？
3. 更喜欢自然风光（山水）还是人文景观（古镇）？
4. 大概预算是多少？（人均500-1000、1000-2000）

这样我可以为您推荐最合适的目的地和行程~
```

### 示例2：多方案规划

**用户需求**：
```
3天2夜，杭州游，2个人，预算每人2000左右
```

**Agent生成方案**：

**方案一：经典打卡版**
- **特点**：西湖+灵隐寺+西溪湿地，涵盖杭州必游景点
- **总预算**：3800元（2人）
- **适配人群**：首次到杭州的游客
- **优点**：不留遗憾，景点经典
- **缺点**：热门景点可能人多

**详细行程**：
```
Day 1：初识西湖
09:00-12:00 | 【西湖景区】
- 游玩时长：3小时
- 交通方式：地铁1号线龙翔桥站 + 步行5分钟
- 必打卡点：断桥残雪、白堤、平湖秋月
- 避坑贴士：早上9点前人少，适合拍照

12:00-13:30 | 【楼外楼午餐】
- 推荐菜品：西湖醋鱼、龙井虾仁、东坡肉
- 人均消费：150元
...
```

**方案二：小众秘境版**
- **特点**：九溪烟树+龙井村+云栖竹径，避开人流深度游
- **总预算**：3200元（2人）
- **适配人群**：深度游爱好者、摄影爱好者
- **优点**：人少景美，独特体验
- **缺点**：交通略不便，需自驾或打车
...

---

## ⚙️ 高级配置

### API参数调优

在 `.env` 文件中可调整以下参数：

```env
# 最大输出token数
# 建议值：4096（可获得更详细的回答）
MAX_TOKENS=4096

# 温度参数（控制回答的随机性）
# 0.0-1.0，越高越随机
# 建议值：0.85（文本规划）/ 0.7（语音交互）
TEMPERATURE=0.85
```

### 支持的模型

#### Claude系列（推荐）
- `claude-3-5-sonnet-20241022` - 最新版，性能最佳
- `claude-3-sonnet-20240229` - 稳定版
- `claude-3-opus-20240229` - 最强版（成本较高）

#### OpenAI系列
- `gpt-4-turbo-preview` - GPT-4 Turbo
- `gpt-4` - GPT-4 标准版
- `gpt-3.5-turbo` - 经济版（效果略弱）

### 自定义Prompt

在 `config/prompts.py` 中可自定义各类Prompt：
- 修改Agent的回答风格
- 添加新的场景适配规则
- 调整输出格式规范
- 扩展专业领域知识

---

## 🐛 常见问题

### Q1: API调用失败怎么办？
**A**: 检查以下几点：
1. `.env` 文件中的 `API_KEY` 是否正确
2. `API_BASE_URL` 是否对应服务商
3. 网络连接是否正常
4. API账户余额是否充足

### Q2: 如何切换其他大模型？
**A**: 修改 `.env` 文件：
```env
# 切换到OpenAI
API_KEY=sk-your_openai_key
API_BASE_URL=https://api.openai.com
MODEL_NAME=gpt-4-turbo-preview
```

### Q3: 图片识别失败？
**A**: 确保：
1. 图片格式为 JPG/PNG/WEBP
2. 图片大小不超过 5MB
3. 图片内容清晰可辨

### Q4: 语音功能如何完善？
**A**: 当前为演示版，完整实现需：
1. 集成语音转文字API（如OpenAI Whisper、百度语音等）
2. 集成文字转语音API（如Azure TTS、Google TTS等）
3. 修改 `app.py` 中的 `process_voice_input` 函数

### Q5: 如何部署到服务器？
**A**: 
```bash
# 后台运行
nohup python app.py > app.log 2>&1 &

# 或使用 screen/tmux
screen -S travel-agent
python app.py
# Ctrl+A+D 分离会话
```

### Q6: 如何开启外网访问？
**A**: 修改 `app.py` 启动参数：
```python
app.launch(
    server_name="0.0.0.0",  # 允许外网访问
    server_port=7860,
    share=True,  # 开启Gradio公共链接（临时）
    auth=("username", "password")  # 添加访问密码
)
```

---

## 🔒 安全建议

1. **保护API密钥**：
   - 不要将 `.env` 文件提交到版本控制系统
   - 不要在公开场合泄露API密钥
   - 定期轮换API密钥

2. **访问控制**：
   - 生产环境建议添加身份验证
   - 使用反向代理（Nginx）添加HTTPS
   - 限制访问IP白名单

3. **数据安全**：
   - 用户对话数据仅保存在本地
   - 不会上传到第三方服务器
   - 定期清理敏感数据

---

## 📊 性能优化

### 提升响应速度
1. 选择地理位置较近的API服务器
2. 使用CDN加速静态资源
3. 开启浏览器缓存

### 降低API成本
1. 使用更经济的模型（如GPT-3.5）
2. 合理设置 `MAX_TOKENS` 参数
3. 实现对话上下文截断策略

---

## 🛣️ 后续规划

- [ ] 集成真实的语音识别和合成API
- [ ] 支持视频内容识别
- [ ] 添加实时天气查询功能
- [ ] 集成地图API显示路线
- [ ] 支持多语言国际化
- [ ] 添加用户反馈和评分功能
- [ ] 开发移动端原生应用

---

## 📄 开源协议

本项目采用 MIT 协议开源，您可以自由使用、修改和分发。

---

## 🙏 致谢

- [Gradio](https://gradio.app/) - 优秀的Python Web界面框架
- [Anthropic](https://www.anthropic.com/) - Claude大模型
- [OpenAI](https://openai.com/) - GPT系列模型

---

## 📞 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 📧 Email: [Your Email]
- 💬 Issues: [GitHub Issues]
- 🌟 Star: 如果觉得项目有帮助，欢迎点个Star！

---

<div align="center">
  <p><strong>🌏 智能旅游助手Agent</strong></p>
  <p>让AI成为您的专属旅游管家</p>
  <p>⭐ 如果觉得有用，请给个Star支持一下！⭐</p>
</div>
