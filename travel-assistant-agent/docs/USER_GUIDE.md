# 📖 用户使用指南

> 从安装到精通 - 智能旅游助手完整使用手册

## 📋 目录

- [快速上手](#快速上手)
- [功能详解](#功能详解)
- [使用示例](#使用示例)
- [常见问题](#常见问题)
- [最佳实践](#最佳实践)

---

## 🚀 快速上手

### 安装步骤

#### 1. 安装依赖
```bash
cd travel-assistant-agent
pip install -r requirements.txt
```

#### 2. 配置 API
```bash
# 复制配置文件
cp .env.example .env

# 编辑 .env 文件,填入 API Key
# 将 your_api_key_here 替换为真实的阿里云千问 API Key
```

#### 3. 启动应用
```bash
# 方式1：直接运行
python app.py

# 方式2：使用启动脚本（推荐）
chmod +x start.sh
./start.sh
```

启动成功后,浏览器会自动打开 http://localhost:7860

---

## 💡 功能详解

### 1. 文本对话

#### 基本用法
在主界面的输入框输入您的旅游需求,点击"发送"或按 Enter 键。

#### 示例对话

**简单询问：**
```
用户：给我推荐一个周末短途旅行目的地
助手：会根据季节、距离、预算等因素推荐合适的目的地
```

**详细规划：**
```
用户：帮我规划一个3天2夜的杭州行程,2个人,预算每人2000左右
助手：会生成详细的行程,包括景点、餐饮、住宿、交通、费用明细
```

**信息补全：**
```
用户：想去旅游
助手：会主动追问：去哪里？玩几天？几个人？预算多少？
```

#### 高级技巧

1. **场景关键词自动适配**
   - 提及"亲子"→ 自动适配儿童友好行程
   - 提及"老人"→ 自动适配低强度行程
   - 提及"穷游"→ 自动适配性价比方案

2. **多轮对话动态调整**
   ```
   第1轮：帮我规划杭州3天行程
   第2轮：行程太赶了,能不能放慢节奏？
   第3轮：想加一个灵隐寺
   ```

3. **多方案对比**
   ```
   用户：去北京5天,预算灵活
   助手：会生成2-3套差异化方案供选择
   ```

### 2. 图片识别

#### 功能说明
上传旅游相关图片,AI 自动识别并提供详细攻略。

#### 支持类型
- **景点照片**：识别景点名称、介绍、门票、开放时间
- **美食图片**：识别菜品、推荐餐厅、价格参考
- **酒店外观**：识别酒店、设施、价格区间
- **地图截图**：优化路线、提供交通建议

#### 使用步骤
1. 点击"图片识别"标签
2. 点击上传区域选择图片（JPG/PNG/WEBP格式）
3. 点击"识别图片"按钮
4. 查看识别结果和攻略建议

#### 最佳实践
- 图片清晰、光线充足
- 图片大小：1-5MB
- 避免过于复杂的场景

### 3. 快速建议

界面提供 6 个预置问题,点击即可快速发送：
- 给我推荐一个适合周末的短途旅行目的地
- 帮我规划一个3天2夜的杭州行程
- 带父母去成都旅游,有什么建议？
- 预算3000元,想去海边玩几天
- 情侣去哪里旅游比较浪漫？
- 学生党想穷游,推荐几个性价比高的地方

### 4. 行程管理

#### 保存行程
- 点击"保存行程"按钮
- 文件保存在 `data/saved_itineraries/` 目录
- 格式：`itinerary_YYYYMMDD_HHMMSS.md`

#### 导出行程
- 点击"行程导出"标签
- 点击"导出为文本"按钮
- 复制文本内容,方便分享

#### 清空对话
- 点击"清空对话"按钮
- 开始新的旅游规划

---

## 🎯 使用示例

### 示例 1：信息不完整 → Agent 主动追问

**用户输入：**
```
想去旅游
```

**Agent 回复：**
```
好的！很高兴帮您规划旅程 ✨

为了给您最合适的方案,想确认几个信息：

1. 您想去哪个城市或国家呢？（比如：杭州、成都、日本、泰国）
2. 计划玩几天？（比如：周末2天、小长假3-5天、深度游7天以上）
3. 大概预算是多少？（人均：2000以内、2000-5000、5000以上）

告诉我这些,我就能为您量身定制完美行程啦！😊
```

---

### 示例 2：信息完整 → 直接生成方案

**用户输入：**
```
帮我规划一个3天2夜的杭州行程,2个人,预算每人2000左右,喜欢自然风光
```

**Agent 回复：**
```
好的！根据您的需求,我为您精心规划了杭州3天2夜行程,预算控制在每人2000元左右 🌿

【行程总览】
- 出行天数：3天2夜
- 出行人数：2人
- 总预算：约4000元（人均2000元）
- 风格定位：自然风光 + 休闲慢游

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 Day 1：初识西湖 - 经典湖光山色

08:30-12:00 | 【西湖景区】免费
- 游玩路线：断桥残雪 → 白堤 → 平湖秋月 → 苏堤春晓
- 游玩时长：3.5小时
- 交通方式：地铁1号线龙翔桥站 + 步行5分钟
- 必打卡点：断桥（白娘子传说地）、三潭印月（远观）
- 💡 避坑贴士：早上8:30前到达,人少适合拍照

12:00-13:30 | 【知味观午餐】
- 推荐菜品：西湖醋鱼、龙井虾仁、叫花鸡
- 人均消费：80元

14:00-17:00 | 【太子湾公园 + 花港观鱼】免费
- 自然风光：春季郁金香、秋季桂花
- 游玩时长：3小时

18:00-19:30 | 【外婆家晚餐】人均60元

20:00 | 入住酒店（布丁酒店/如家,200-250元/晚）

💰 Day1 费用：350元/人

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【总预算明细】
- 住宿：500元（2晚×250元）
- 餐饮：840元（7餐）
- 门票：160元
- 交通：300元
- 其他：200元
- **总计：2000元/人**

【贴心贴士】
✅ 提前预订：灵隐寺需在官方公众号提前预约
✅ 交通卡：购买杭州通（地铁公交通用）
✅ 最佳季节：春季3-5月、秋季9-11月
✅ 穿搭建议：舒适运动鞋 + 防晒用品

祝您杭州之旅愉快！🌸
```

---

### 示例 3：多方案对比

**用户输入：**
```
想去北京玩5天,3个大人1个6岁小孩,预算灵活
```

**Agent 回复：**
```
好的！根据您的家庭结构,我为您准备了3套北京5天行程方案：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 方案一：经典亲子深度游

**总预算**：1.2万元（4人）= 人均3000元
**方案特点**：涵盖故宫、长城等必游景点,融入动物园、科技馆等儿童友好场所
**适配人群**：首次到北京的家庭,想全面体验

**优点**：
✅ 景点全面不留遗憾
✅ 儿童友好设施完善
✅ 行程强度适中

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 方案二：文化历史深度版

**总预算**：9000元（4人）= 人均2250元
**方案特点**：重文化轻娱乐,深度游故宫、颐和园、胡同
**适配人群**：注重文化教育的家庭

**优点**：
✅ 寓教于乐,孩子增长见识
✅ 行程舒缓,老少皆宜
✅ 性价比高

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 方案三：欢乐亲子轻奢版

**总预算**：1.8万元（4人）= 人均4500元
**方案特点**：重娱乐轻景点,环球影城、野生动物园、科技馆
**适配人群**：预算充足,以孩子为中心的家庭

**优点**：
✅ 孩子超级开心
✅ 住宿体验好（亲子主题房）
✅ VIP快速通道,无需排队

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 **我的建议**：推荐方案一（经典亲子深度游）,兼顾大人和孩子的需求,性价比最高。

您觉得哪套方案更适合？也可以告诉我偏好,我帮您混搭调整！😊
```

---

### 示例 4：场景自动适配（老年游）

**用户输入：**
```
带爸妈去成都玩4天,他们都60多岁了
```

**Agent 回复：**
```
好的！为您的父母精心规划成都4天轻松游,充分考虑老年人的身体状况 👴👵

【行程总原则】
✅ 低强度：每天只安排2-3个景点
✅ 舒适度优先：选择有观光车、休息区的景点
✅ 就近住宿：减少奔波
✅ 饮食清淡：地道但不油腻的川菜

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 Day 1：慢游古街 - 轻松开场

09:00 | 睡到自然醒,酒店早餐
10:30 | 【宽窄巷子】免费
- 游玩时长：2小时（走走停停,不赶时间）
- 💡 老人友好：全程平路,步行距离短,随处有座椅休息
- 📍 轮椅租赁：游客中心可免费借用

12:30 | 【蜀九香火锅】清汤锅（少油少辣）

14:00-15:30 | 回酒店午休（重要！）

16:00 | 【人民公园】免费
- 游玩项目：喝茶、看鹤鸣茶社
- 💡 老人最爱：坐在茶社晒太阳、采耳（50元）

18:00 | 晚餐：【钦善斋】药膳餐厅（养生、清淡）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【👴👵 老年人出行专属贴士】

**行前准备**
✅ 提前办理老年证/身份证（65岁以上很多景点免费）
✅ 常备药品：降压药、速效救心丸、肠胃药
✅ 舒适鞋：软底防滑运动鞋

**医疗保障**
✅ 最近医院：华西医院（三甲）
✅ 24小时药店：多家连锁药店

**饮食建议**
✅ 避免纯麻辣：点"鸳鸯锅"或"清汤锅"
✅ 多吃软烂食物：豆腐、滑肉、蒸菜
```

---

### 示例 5：动态调整

**第 1 轮对话：**
```
用户：帮我规划杭州3天行程
助手：（生成完整行程）
```

**第 2 轮对话：**
```
用户：行程太赶了,能不能放慢节奏？
助手：好的！我帮您优化调整：
      - Day1：删除了花港观鱼,增加了休息时间
      - Day2：推迟了出发时间,从8:00改为9:00
      - Day3：删除了河坊街,提前返程避免劳累
```

**第 3 轮对话：**
```
用户：想加一个灵隐寺
助手：好的！已添加灵隐寺：
      - 安排在 Day2 下午
      - 调整了原行程时间
      - 门票75元（含飞来峰）
      - 需提前在公众号预约
```

---

## ❓ 常见问题

### 1. 如何获取 API Key?

1. 访问 [阿里云百炼平台](https://bailian.console.aliyun.com/)
2. 注册并开通千问服务
3. 在"API-KEY管理"中创建 API Key
4. 复制 Key 到 `.env` 文件

### 2. 请求超时怎么办?

**原因：**网络波动或模型响应慢

**解决方案：**
1. 检查网络连接
2. 增加超时时间：编辑 `.env` 文件
   ```env
   TEXT_API_TIMEOUT=90
   MULTIMODAL_API_TIMEOUT=120
   ```
3. 减少生成长度：
   ```env
   MAX_TOKENS=1200
   ```

### 3. 图片识别失败?

**可能原因：**
- 图片格式不支持（仅支持 JPG/PNG/WEBP）
- 图片过大或过小
- 图片内容不清晰

**解决方案：**
- 图片大小：1-5MB
- 图片清晰、光线充足
- 避免复杂场景

### 4. 如何获得更好的规划结果?

**提供详细信息：**
```
好的示例：
"帮我规划一个3天2夜的杭州行程,2个人,预算每人2000左右,喜欢自然风光,不想太累"

不好的示例：
"去杭州玩"
```

**使用场景关键词：**
- 亲子游、老年游、穷游、情侣游、轻奢游

**多轮对话细化：**
- 先生成初步方案
- 再根据反馈调整优化

---

## 💡 最佳实践

### 1. 高效提问技巧

**明确需求：**
- ✅ "3天2夜杭州行程,2人,预算2000/人,喜欢自然风光"
- ❌ "去杭州玩"

**使用关键词：**
- ✅ "带爸妈去成都,他们60多岁"（触发老年游适配）
- ✅ "学生穷游,预算有限"（触发性价比方案）

**分步细化：**
- 第1步：基础规划
- 第2步：细化调整
- 第3步：优化完善

### 2. 功能组合使用

**文本 + 图片：**
```
1. 先用文本生成行程
2. 上传景点图片获取详细攻略
3. 根据攻略调整行程
```

**快速建议 + 自定义：**
```
1. 点击快速建议了解示例
2. 根据示例自定义需求
3. 多轮对话精细化
```

### 3. 行程管理技巧

**及时保存：**
- 对满意的方案立即点击"保存行程"

**版本对比：**
- 保存多个版本方案
- 对比选择最优方案

**导出分享：**
- 使用"导出为文本"功能
- 复制内容分享给同行伙伴

---

## 📝 使用小贴士

1. **首次使用建议**
   - 先尝试快速建议的预置问题
   - 熟悉 Agent 的回复风格
   - 再进行自定义规划

2. **网络环境**
   - 确保网络稳定
   - 首次加载可能较慢（正常现象）

3. **浏览器兼容性**
   - 推荐使用 Chrome、Edge、Safari
   - 避免使用过旧的浏览器版本

4. **隐私保护**
   - 对话历史仅保存在本地
   - 不会上传到服务器

---

**🎉 享受智能旅游规划的便利吧！**

如有问题,请参考 [常见问题](../README.md#常见问题) 或提交 GitHub Issue。
