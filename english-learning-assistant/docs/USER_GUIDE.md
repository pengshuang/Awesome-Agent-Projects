# 📖 用户使用指南

欢迎使用AI英语学习助手！本指南将帮助你快速上手并充分利用所有功能。

---

## 📋 目录

1. [系统安装](#系统安装)
2. [配置说明](#配置说明)
3. [功能详解](#功能详解)
4. [使用技巧](#使用技巧)
5. [常见问题](#常见问题)

---

## 🚀 系统安装

### 前置要求

- **操作系统**: Windows / macOS / Linux
- **Python版本**: 3.8 或更高
- **网络**: 稳定的互联网连接
- **API密钥**: 需要有可用的LLM API密钥（如通义千问）

### 安装步骤

#### 1. 获取代码

```bash
cd english-learning-assistant
```

#### 2. 初始化系统

```bash
python3 init_system.py
```

系统会自动：
- 创建必要的目录结构
- 生成配置文件模板
- 检查环境依赖

#### 3. 配置API密钥

编辑项目根目录下的 `.env` 文件：

```env
# 必填项
LLM_API_KEY=你的API密钥

# 可选项（使用默认值即可）
LLM_API_BASE=https://dashscope.aliyuncs.com/api/v1
LLM_MODEL=qwen-plus
```

**获取API密钥：**
- 通义千问：访问 https://dashscope.aliyun.com/
- OpenAI：访问 https://platform.openai.com/

#### 4. 启动应用

**方式一：使用启动脚本（推荐）**
```bash
chmod +x start.sh
./start.sh
```

**方式二：直接运行**
```bash
# 先安装依赖
pip install -r requirements.txt

# 启动应用
python3 web_ui.py
```

#### 5. 访问界面

启动成功后，在浏览器中打开：
```
http://localhost:7860
```

---

## ⚙️ 配置说明

### 基础配置

`.env` 文件中的关键配置项：

```env
# ========== LLM API配置 ==========
LLM_API_KEY=sk-xxx              # 你的API密钥
LLM_API_BASE=https://...        # API地址
LLM_MODEL=qwen-plus            # 使用的模型

# ========== 模型参数 ==========
TEMPERATURE=0.7                 # 创造性(0-2)，越高越随机
MAX_TOKENS=2000                # 最大输出长度
TOP_P=0.8                      # 采样参数
API_TIMEOUT=60                 # 超时时间(秒)
STREAM_ENABLED=true            # 是否启用流式输出

# ========== 学习配置 ==========
DEFAULT_DIFFICULTY=中级         # 默认难度级别

# ========== 服务器配置 ==========
GRADIO_SERVER_NAME=0.0.0.0     # 服务器地址
GRADIO_SERVER_PORT=7860        # 端口号
GRADIO_SHARE=false             # 是否创建公网链接
```

### 高级配置

如果需要使用不同的API服务，可以单独配置语音和视觉API：

```env
# 语音转文字
STT_API_KEY=你的STT密钥
STT_API_BASE=https://...

# 文字转语音
TTS_API_KEY=你的TTS密钥
TTS_API_BASE=https://...

# 视觉识别
VISION_API_KEY=你的Vision密钥
VISION_API_BASE=https://...
VISION_MODEL=qwen-vl-plus
```

---

## 🎯 功能详解

### 1️⃣ AI智能对话

**功能介绍：**
与AI英语导师进行一对一对话练习，AI会根据你的水平提供个性化指导。

**使用步骤：**

1. 选择学习难度（初级/中级/高级）
2. 在输入框中输入你的问题或想说的话
3. 点击"发送"或按回车键
4. AI会实时回复并提供学习指导

**功能亮点：**
- ✅ 自动记忆对话上下文
- ✅ 实时纠正语法错误
- ✅ 根据水平调整对话难度
- ✅ 主动引导学习话题

**使用示例：**

```
你：I want to learning English.
AI：Good start! 不过这里有个小错误，应该是 "I want to learn 
English"（不是 "learning"）。"want to" 后面要接动词原形。
让我们继续练习...
```

**实用技巧：**
- 💡 不懂就问，AI导师会耐心解答
- 💡 尝试用英文表达日常想法
- 💡 定期点击"生成学习总结"查看进步
- 💡 查看"学习档案"了解薄弱环节

---

### 2️⃣ 翻译解析

**功能介绍：**
不只是简单翻译，还提供详细的语言学习解析。

#### 📌 通用翻译

**适用场景：**
- 翻译句子或段落
- 需要了解语法结构
- 学习地道表达方式

**输出内容：**
- 准确的翻译
- 核心词汇讲解
- 语法结构分析
- 文化背景说明
- 学习建议

**示例：**
```
输入：The early bird catches the worm.

输出：
## 翻译结果
早起的鸟儿有虫吃。（比喻：勤奋的人会获得机会）

## 详细解析
### 核心词汇
- early bird: 早起的人，勤奋的人
- catch: 抓住（过去式caught）
- worm: 虫子

### 语法结构
- 主语：The early bird（定冠词 + 形容词 + 名词）
- 谓语：catches（第三人称单数）
- 宾语：the worm

### 文化背景
这是一句英语谚语，强调勤奋和主动的重要性...
```

#### 📌 单词解析

**适用场景：**
- 深入学习单个单词
- 了解词汇用法和搭配
- 记忆单词

**输出内容：**
- 音标（英式/美式）
- 所有词性和释义
- 常用搭配
- 实用例句
- 词根词缀
- 同义词/反义词
- 记忆技巧

**示例：**
```
输入：achieve

输出：
## 音标
- 英式: /əˈtʃiːv/
- 美式: /əˈtʃiv/

## 词性
**动词 (v.)**: 达到，完成，实现

## 常用搭配
- achieve a goal 达成目标
- achieve success 取得成功
- achieve one's dream 实现梦想

## 例句
1. She worked hard to achieve her goals.
   她努力工作以达成目标。
2. We finally achieved what we set out to do.
   我们终于完成了我们打算做的事。

## 词根词缀
- 前缀 a- (to)
- 词根 chief (头目) → 到达顶端 → 达成

## 记忆技巧
联想：achieve = a + chief，想象自己成为首领(chief)，
就是达成(achieve)了目标！
```

#### 📌 长难句解析

**适用场景：**
- 理解复杂句子结构
- 分析从句和特殊结构
- 准备考试阅读

**输出内容：**
- 中文翻译
- 句子成分分析
- 主从句划分
- 语法要点讲解
- 简化理解

**示例：**
```
输入：The book that I bought yesterday, which was recommended 
by my teacher, is very interesting.

输出：
## 中文翻译
我昨天买的那本书，是我老师推荐的，非常有趣。

## 句子结构分析
**主句：** The book is very interesting.
**定语从句1：** that I bought yesterday（修饰book）
**定语从句2：** which was recommended by my teacher（修饰book）

## 语法要点
1. 两个定语从句并列修饰同一个名词
2. that引导限制性定语从句
3. which引导非限制性定语从句（有逗号）

## 简化理解
这是一个"主句+双重定语从句"的结构。可以拆分为：
1. The book is interesting.（主要信息）
2. I bought it yesterday.（次要信息1）
3. My teacher recommended it.（次要信息2）
```

---

### 3️⃣ 写作批改

#### 📌 作文批改

**功能介绍：**
全方位批改你的英文作文，从语法到逻辑，提供详细反馈和评分。

**使用步骤：**
1. 在"作文内容"框中粘贴你的英文作文
2. 填写"写作要求"（如：邮件、议论文等）
3. 点击"开始批改"

**输出内容：**
- ✅ 总体评价
- ❌ 语法错误纠正
- ❌ 拼写错误纠正
- 💡 用词建议
- 📊 改进建议（句式、词汇、逻辑）
- ⭐ 优秀范文
- 🎯 评分（总分100）

**评分维度：**
- 内容 (Content): 25分
- 组织 (Organization): 25分
- 词汇 (Vocabulary): 25分
- 语法 (Grammar): 25分

#### 📌 写作润色

**功能介绍：**
让你的英文表达更地道、更流畅、更符合特定场景。

**适用场景：**
- 邮件润色
- 论文优化
- 简历美化
- 演讲稿改进

**目标风格：**
- **日常**: 口语化、自然
- **学术**: 正式、严谨
- **商务**: 专业、礼貌
- **创意**: 生动、有趣

**示例：**
```
原文（日常）：
I want to tell you that I can't come to the party.

润色后（商务邮件）：
I regret to inform you that I will be unable to attend 
the party due to a prior commitment.
```

---

### 4️⃣ 口语练习

#### 📌 跟读练习

**功能介绍：**
听标准发音，跟读练习，获得AI评分。

**使用步骤：**

1. **输入练习文本**
   - 可以输入任何英文句子
   - 系统提供默认练习句

2. **选择发音类型**
   - 美式女声 (samantha)
   - 美式男声 (harry)
   - 英式女声 (emily)

3. **调整语速**
   - 0.5x - 2.0x
   - 初学者建议用0.8x

4. **生成语音**
   - 点击"生成语音"
   - 播放并反复听

5. **录制你的发音**
   - 点击麦克风图标开始录音
   - 跟读练习文本
   - 再次点击停止

6. **评估发音**
   - 点击"评估发音"
   - 获得详细评分和建议

**评分维度：**
- 准确度 (Accuracy): 发音正确性
- 流利度 (Fluency): 语速和停顿
- 完整度 (Completeness): 是否完整读完
- 总分 (Overall): 综合评分

#### 📌 自由录音

**功能介绍：**
自由录制你的英语口语，AI自动识别并转为文字。

**使用步骤：**
1. 点击麦克风开始录音
2. 说英语（可以自由表达）
3. 点击停止
4. 点击"识别语音"
5. 查看识别结果

**应用场景：**
- 练习自由表达
- 测试发音是否清晰
- 将口语想法转为文字

---

### 5️⃣ 图片/PDF解析

**功能介绍：**
上传包含英文内容的图片或PDF，AI自动识别并提供翻译和讲解。

**支持格式：**
- 图片：JPG, PNG, GIF, BMP, WebP
- 文档：PDF

**使用步骤：**
1. 点击"上传文件"
2. 选择图片或PDF文件
3. 点击"开始解析"
4. 等待AI分析

**输出内容：**
- 📝 识别的英文内容
- 🔤 中文翻译
- 📚 知识点讲解
- 💡 重点词汇和语法
- 🌍 文化背景（如适用）
- 🎯 学习建议

**应用场景：**
- 翻译路牌、菜单、标识
- 学习英文教材扫描件
- 阅读英文论文PDF
- 理解外文图书
- 学习英文海报、广告

**示例场景：**

**场景1：菜单翻译**
- 上传餐厅英文菜单照片
- AI识别菜品名称
- 提供中文翻译
- 讲解相关词汇

**场景2：文献学习**
- 上传学术论文PDF
- AI提取关键内容
- 翻译专业术语
- 解释复杂句式

---

### 6️⃣ Prompt管理

**功能介绍：**
查看和调整系统的所有Prompt模板，定制化AI的回复风格。

**可管理的Prompt：**
- Agent系统提示词
- Agent对话提示词
- 翻译解析提示词
- 单词解析提示词
- 长难句解析提示词
- 写作批改提示词
- 写作润色提示词
- 口语纠错提示词
- 口语练习提示词
- 图片解析提示词
- PDF解析提示词
- 学习总结提示词
- 难度调整提示词

**使用步骤：**
1. 选择要查看的Prompt类型
2. 点击"加载Prompt"
3. 在编辑器中查看/修改内容
4. 点击"保存修改"（仅当前会话有效）

**注意事项：**
- ⚠️ 修改仅在当前会话有效，重启后恢复
- 💡 不建议随意修改，可能影响功能
- 📝 可以参考现有格式进行微调
- 🔧 高级用户可以优化Prompt提升效果

---

## 💡 使用技巧

### 1. AI对话技巧

**✅ 做到：**
- 勇敢开口，不怕犯错
- 用完整句子表达想法
- 主动询问不懂的知识点
- 定期查看学习总结

**❌ 避免：**
- 只发单词或短语
- 照抄书本内容
- 不思考直接要答案

### 2. 学习难度选择

**初级适合：**
- 英语基础薄弱
- 词汇量 < 2000
- 简单日常对话

**中级适合：**
- 有一定基础
- 词汇量 2000-5000
- 能进行基本交流

**高级适合：**
- 英语水平较好
- 词汇量 > 5000
- 需要专业表达

### 3. 口语练习建议

- 🎯 每天坚持10分钟跟读
- 🎯 从慢速开始，逐步提高
- 🎯 重点练习薄弱的发音
- 🎯 录音对比，找出差距

### 4. 写作提升策略

- ✍️ 先自己写，再用AI批改
- ✍️ 认真阅读AI的修改建议
- ✍️ 记录常犯错误，针对性改进
- ✍️ 模仿优秀范文的表达

### 5. 学习记录管理

系统会自动保存：
- 对话历史
- 学习记录
- 薄弱项分析

定期查看这些数据，了解自己的进步！

---

## ❓ 常见问题

### 安装和配置

**Q1: 启动时提示"未找到Python 3"怎么办？**

A: 需要先安装Python 3.8或更高版本。
- macOS/Linux: `brew install python3` 或从官网下载
- Windows: 访问 python.org 下载安装

**Q2: 提示"API密钥未配置"怎么办？**

A: 编辑 `.env` 文件，填入你的API密钥：
```env
LLM_API_KEY=你的密钥
```

**Q3: 启动后无法访问界面？**

A: 检查：
- 端口7860是否被占用
- 防火墙是否允许访问
- 尝试访问 `http://127.0.0.1:7860`

### 功能使用

**Q4: AI回复很慢或超时？**

A: 可能原因：
- 网络连接不稳定
- API服务繁忙
- 可以增加 `API_TIMEOUT` 配置

**Q5: 语音功能无法使用？**

A: 检查：
- 麦克风权限是否允许
- 浏览器是否支持（建议用Chrome）
- 麦克风设备是否正常

**Q6: 图片/PDF解析失败？**

A: 确保：
- 文件格式正确
- 文件不要过大（建议<10MB）
- 图片/PDF中有清晰的英文文字

**Q7: 翻译结果不准确？**

A: 可以尝试：
- 检查输入文本是否有错别字
- 提供更多上下文
- 切换到更高级的模型
- 调整 `TEMPERATURE` 参数

### 学习相关

**Q8: 如何知道自己的薄弱项？**

A: 
- 查看"学习档案"
- 生成"学习总结"
- 系统会自动追踪常见错误

**Q9: 可以保存对话历史吗？**

A: 系统自动保存在 `data/history/` 目录下，可以随时查看。

**Q10: 如何调整学习难度？**

A: 在AI对话界面，选择右侧的难度选项（初级/中级/高级）。

### 技术问题

**Q11: 日志在哪里查看？**

A: 日志文件在 `logs/` 目录：
- `app.log`: 应用日志
- `error.log`: 错误日志
- `api.log`: API调用日志

**Q12: 如何更换API服务商？**

A: 编辑 `.env` 文件，修改：
```env
LLM_API_BASE=新的API地址
LLM_MODEL=新的模型名称
```

**Q13: 可以在服务器上部署吗？**

A: 可以！修改配置：
```env
GRADIO_SERVER_NAME=0.0.0.0
GRADIO_SHARE=false
```
然后通过服务器IP访问。

---

## 📞 获取帮助

如果遇到问题：

1. 📖 查看本文档的常见问题部分
2. 📂 检查 `logs/` 目录下的日志文件
3. 🐛 在GitHub提交Issue
4. 💬 联系技术支持

---

## 🎓 学习建议

### 初学者（初级）

**每日学习计划：**
- ☀️ 早上：20分钟AI对话练习
- 🌆 下午：15分钟单词学习
- 🌙 晚上：10分钟口语跟读

**学习重点：**
- 基础词汇积累
- 简单句型练习
- 发音标准化

### 进阶学习者（中级）

**每日学习计划：**
- ☀️ 早上：30分钟AI对话
- 🌆 下午：写一篇短文并批改
- 🌙 晚上：15分钟口语练习

**学习重点：**
- 语法准确性
- 词汇量扩充
- 表达多样性

### 高级学习者（高级）

**每日学习计划：**
- ☀️ 早上：阅读英文文章+解析
- 🌆 下午：写作练习+润色
- 🌙 晚上：自由对话练习

**学习重点：**
- 地道表达
- 专业词汇
- 文化理解

---

**祝你学习愉快，英语水平稳步提升！🚀**
