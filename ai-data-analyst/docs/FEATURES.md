# 功能介绍

> 面向所有用户的功能说明文档

## 🎯 产品定位

AI 数据分析助手是一款智能数据分析工具，让您通过**自然语言**完成数据查询、分析和可视化，无需编写 SQL 或代码。

---

## 核心功能

### 1. 多数据源支持 🗄️

#### SQLite 数据库
- 连接本地数据库文件
- 自动识别数据库结构
- 支持复杂 SQL 查询
- 自动修正 SQL 语法错误

#### 文件数据源
- 支持格式：CSV、Excel (.xlsx/.xls)、JSON、Parquet
- 自动识别文件格式
- 数据预览和统计
- 智能数据解析

#### 知识库
- 上传文档自动构建知识库
- 支持 PDF、Word、Markdown 等格式
- 基于语义的智能搜索
- 快速问答和信息检索

#### Web 搜索
- 获取实时互联网信息
- 多个搜索结果聚合
- 自动提取关键内容

---

### 2. 自然语言查询 (NL2SQL) 💬

**核心能力**：将日常语言转换为数据库查询

**示例**：
```
输入: "查询2024年销售额最高的5个产品"
↓
自动生成SQL:
SELECT product_name, SUM(sales_amount) as total_sales
FROM sales
WHERE YEAR(sale_date) = 2024
GROUP BY product_name
ORDER BY total_sales DESC
LIMIT 5
```

**特点**：
- 理解中文和英文问题
- 自动生成标准 SQL
- 支持复杂查询（JOIN、子查询等）
- SQL 语法高亮显示

---

### 3. 数据可视化 📊

**交互式图表**（基于 Plotly）

| 图表类型 | 适用场景 | 示例 |
|---------|---------|------|
| 📊 柱状图 | 分类数据对比 | 各产品销量对比 |
| 📈 折线图 | 趋势分析 | 月度销售趋势 |
| ⚫ 散点图 | 相关性分析 | 价格与销量关系 |
| 🥧 饼图 | 占比分析 | 市场份额分布 |
| 📉 面积图 | 累积趋势 | 累计销售额 |
| 📦 箱线图 | 分布分析 | 价格区间分布 |

**使用流程**：
1. 在对话中执行数据查询
2. 切换到「数据可视化」标签页
3. 选择图表类型和数据列
4. 自动生成交互式图表

**特色**：
- 零代码创建图表
- 实时交互（缩放、悬停、筛选）
- 自动数据类型识别
- 支持颜色分组

---

### 4. 多轮对话 🔄

**上下文理解**

系统会记住对话历史，理解上下文：

```
用户: 查询销售数据
助手: [返回销售数据]

用户: 按地区分组
助手: [理解是对上一次查询的补充，自动重新查询]

用户: 只显示前10名
助手: [继续基于上下文，显示前10名地区]
```

**特点**：
- 记忆历史对话（可配置轮数）
- 理解省略和指代
- 连贯的对话体验

---

### 5. 数据分析报告 📝

**自动生成结构化报告**

- 📋 数据摘要
- 📊 关键指标
- 💡 数据洞察
- 📈 趋势分析
- ✅ 结论建议

**输出格式**：
- Markdown 格式
- 包含数据表格
- 可视化建议
- 可复制分享

---

### 6. 多数据源融合分析 🔗

**跨数据源协同**

- 同时查询数据库和文件
- 结合知识库信息
- 融合实时网络数据
- 综合分析输出

**应用场景**：
- 业务数据 + 行业知识库
- 历史数据 + 实时新闻
- 多个数据表融合分析

---

## 技术特性

### LLM 支持

| 提供商 | 模型示例 | 特点 |
|--------|---------|------|
| OpenAI | GPT-3.5/GPT-4 | 通用性强 |
| DeepSeek | deepseek-chat | 性价比高 |
| 阿里云 | 通义千问 | 中文优化 |
| 本地 | Ollama/LM Studio | 数据安全 |

### 日志系统

- 完整的操作日志
- LLM 调用记录（包含 Prompt）
- 自动日志轮转
- 便于调试和追踪

### 安全特性

- 本地数据处理
- API Key 加密存储
- 日志脱敏
- 数据隔离

---

## 使用场景

### 业务分析
- 销售数据分析
- 用户行为分析
- 财务报表查询
- 库存管理分析

### 数据探索
- 探索性数据分析（EDA）
- 数据质量检查
- 异常值检测
- 相关性分析

### 报告生成
- 周报/月报自动生成
- 数据总结提取
- 可视化报告
- 决策支持材料

### 知识问答
- 企业知识库问答
- 文档快速检索
- 政策规范查询
- 技术文档助手

---

## 优势特点

### ✅ 易用性
- 自然语言交互
- 零代码操作
- 可视化界面
- 快速上手

### ✅ 灵活性
- 多数据源支持
- 多种图表类型
- 可配置参数
- 扩展性强

### ✅ 智能性
- AI 驱动分析
- 上下文理解
- 自动报告生成
- 决策建议

### ✅ 可靠性
- 完整日志记录
- 错误自动修正
- 数据验证
- 稳定运行

---

## 下一步

- 📖 查看 [用户指南](USER_GUIDE.md) 了解如何使用
- 💻 查看 [开发指南](DEVELOPER_GUIDE.md) 了解如何扩展
```
用户：查询销售数据
助手：[展示销售数据表]

用户：按地区分组
助手：[理解是对上一个查询的补充，重新查询并按地区分组]

用户：只看前5名
助手：[继续基于上下文，显示前5名地区]
```

### 7. 数据可视化 ✨ 新功能

**交互式图表**
- 基于 Plotly 的高质量可视化
- 支持多种图表类型
- 实时交互操作（缩放、悬停、筛选）
- 美观的默认样式

**支持的图表类型**：
- 📊 柱状图：分类数据对比
- 📈 折线图：趋势分析
- ⚫ 散点图：相关性分析
- 🥧 饼图：占比分析
- 📉 面积图：累积趋势
- 📦 箱线图：分布分析

**可视化流程**：
1. 在对话分析中执行查询
2. 系统自动提取查询结果
3. 切换到可视化标签页
4. 选择图表类型和数据列
5. 实时生成交互式图表

**特性**：
- 自动数据类型识别
- 智能列映射建议
- 支持颜色分组
- 数据表格同步显示
- 零代码图表创建

## 技术特性

### LLM 支持

支持多种大语言模型 API：
- **OpenAI**：GPT-3.5、GPT-4
- **DeepSeek**：DeepSeek-Chat
- **阿里云**：通义千问系列
- **其他**：任何 OpenAI 兼容 API

### Embedding 模型

支持多种向量化模型：
- OpenAI Embedding
- HuggingFace 模型（如 BGE、M3E）
- FastEmbed
- 本地模型

### 日志系统

**完整的日志记录**
- 所有 LLM 调用的 Prompt 记录
- 系统运行日志
- 错误日志单独记录
- 日志自动轮转和压缩

**用于 Debug**：
每次调用 LLM 时都会打印：
```
======================================================================
📝 [LLM调用] NL2SQL转换
======================================================================
输入Prompt:
你是一位SQL专家，请将用户的自然语言问题转换为SQL查询语句。
...
======================================================================
```

### 安全性

- 环境变量管理敏感信息
- SQL 注入防护
- 错误处理和异常捕获
- 数据访问权限控制

## 适用场景

### 业务分析
- 销售数据分析
- 用户行为分析
- 财务报表分析
- 运营数据监控

### 数据探索
- 探索性数据分析（EDA）
- 数据质量检查
- 异常值检测
- 趋势分析

### 知识管理
- 企业知识库问答
- 文档检索和总结
- 政策法规查询
- 技术文档搜索

### 决策支持
- 市场趋势分析
- 竞争对手分析
- 风险评估
- 策略制定

## 性能优势

- **快速响应**：优化的数据查询和索引
- **可扩展**：模块化设计，易于扩展新数据源
- **稳定性**：完善的错误处理和日志系统
- **易用性**：自然语言交互，无需编程经验
